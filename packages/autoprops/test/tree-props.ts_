import test from 'blue-tape'
import autoprops from '../src'

test('Get Props: boolean triple state', async (t) => {
  const { props: childProps } = autoprops({
    props: {
      foo: [undefined, 'foo content'],
      bar: [undefined, 'bar content'],
    },
    mutex: [
      ['foo', 'bar'],
    ],
  })
  const { props: child2Props } = autoprops({
    props: {
      children: [
        undefined,
        ...autoprops({
          props: {
            FooChild: [undefined, 'content'],
            BarChild: [undefined, 'content'],
          },
          mutex: [
            ['FooChild', 'BarChild'],
          ],
        }).props,
      ],
    },
    mutex: [],
  })
  const { props: children } = autoprops({
    props: {
      Child1: [undefined, ...childProps],
      Child2: [undefined, ...child2Props],
    },
    mutex: [
      ['Child1', 'Child2'],
    ],
  })
  const { props: result } = autoprops({
    props: {
      children: ['ChildContent', ...children],
    },
    mutex: [],
  })

  // console.log(result)

  /* values */
  t.deepEquals(
    result,
    [
      {
        children: 'ChildContent',
      },
      {
        children: {},
      },
      {
        children: {
          Child1: {},
        },
      },
      {
        children: {
          Child1: { foo: 'foo content' },
        },
      },
      {
        children: {
          Child1: { bar: 'bar content' },
        },
      },
      {
        children: {
          Child2: {},
        },
      },
      {
        children: {
          Child2: {
            children: {},
          },
        },
      },
      {
        children: {
          Child2: {
            children: {
              FooChild: 'content',
            },
          },
        },
      },
      {
        children: {
          Child2: {
            children: {
              BarChild: 'content',
            },
          },
        },
      },
    ]
  )
})
